ä»¥ä¸‹æ˜¯ OpenAI å¹³å°æ–‡æ¡£å·¦ä¾§ç›®å½•çš„ä¸­æ–‡ç¿»è¯‘åŠç»“æ„è¯´æ˜ï¼Œé€‚åˆåˆå­¦è€…å¿«é€Ÿäº†è§£ã€‚
[openai](https://platform.openai.com/docs/overview)

OpenAI å¹³å°æ–‡æ¡£å·¦ä¾§ç›®å½•ï¼ˆä¸­æ–‡ç‰ˆï¼‰

- å…¥é—¨
  - æ¦‚è§ˆ
  - å¿«é€Ÿå¼€å§‹
  - å¼€å‘åº“
- æ ¸å¿ƒæ¦‚å¿µ
  - æ–‡æœ¬ä¸æç¤º
  - å›¾åƒä¸è§†è§‰ã€éŸ³é¢‘ä¸è¯­éŸ³
  - ç»“æ„åŒ–è¾“å‡ºï¼ˆonly jsonï¼Ÿï¼‰
  - å‡½æ•°è°ƒç”¨ï¼ˆå¤šä¸ªå¹¶è¡Œï¼‰
- API æŒ‡å—
  - ä¼šè¯çŠ¶æ€ï¼ˆå¤šè½®å¯¹è¯æºå¸¦ï¼‰
  - æµå¼ä¼ è¾“ï¼ˆæ•°æ®æ¥å£ã€ç”Ÿå‘½å‘¨æœŸtypeï¼‰
  - æ–‡ä»¶è¾“å…¥
  - åå°æ¨¡å¼
  - Webhooks
  - æ‰¹é‡å¤„ç†
  - æ¨ç†
  - æ·±åº¦ç ”ç©¶
- å·¥å…·
  - å·¥å…·ä½¿ç”¨
  - è¿œç¨‹ MCP
  - ç½‘ç»œæœç´¢
  - æ–‡ä»¶æœç´¢
  - å›¾åƒç”Ÿæˆ
  - ä»£ç è§£é‡Šå™¨
  - è®¡ç®—æœºæ“ä½œ
- æ™ºèƒ½ä½“ï¼ˆAgentsï¼‰
  - æ„å»ºæ™ºèƒ½ä½“
  - è¯­éŸ³æ™ºèƒ½ä½“
  - æ™ºèƒ½ä½“ SDKï¼ˆTypeScriptï¼‰
- å®æ—¶ API
  - ä½¿ç”¨å®æ—¶ API
  - å®æ—¶å¯¹è¯
  - å®æ—¶è½¬å½•
  - è¯­éŸ³æ´»åŠ¨æ£€æµ‹
- æ¨¡å‹ä¼˜åŒ–
  - æ¦‚è§ˆ
  - è¯„æµ‹ï¼ˆEvalsï¼‰
  - ç›‘ç£å¾®è°ƒ
  - è§†è§‰å¾®è°ƒ
  - ç›´æ¥åå¥½ä¼˜åŒ–
  - å¼ºåŒ–å¾®è°ƒ
  - è¯„åˆ†å™¨
  - è’¸é¦
- ä¸“ç”¨æ¨¡å‹
  - å›¾åƒç”Ÿæˆã€æ–‡æœ¬è½¬è¯­éŸ³ã€è¯­éŸ³è½¬æ–‡æœ¬
  - å‘é‡åµŒå…¥
  - å†…å®¹å®¡æ ¸
- Codex
  - Codex
  - æ™ºèƒ½ä½“è”ç½‘
  - æœ¬åœ° Shell å·¥å…·
  - Codex CLI
  - Codex æ›´æ–°æ—¥å¿—
- æœ€ä½³å®è·µ
  - ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ
  - å®‰å…¨æœ€ä½³å®è·µ
  - æç¤ºç¼“å­˜
  - é¢„æµ‹è¾“å‡º
  - æ¨ç†æœ€ä½³å®è·µ
  - è¯„æµ‹è®¾è®¡
  - å¾®è°ƒæœ€ä½³å®è·µ
  - å¼ºåŒ–å¾®è°ƒç”¨ä¾‹
  - æ¨¡å‹é€‰æ‹©
  - å»¶è¿Ÿä¼˜åŒ–
  - å‡†ç¡®ç‡ä¼˜åŒ–
  - é«˜çº§ç”¨æ³•
  - Responses ä¸ Chat Completions
  - çµæ´»å¤„ç†
- åŠ©æ‰‹ API
  - æ¦‚è§ˆ
  - å¿«é€Ÿå¼€å§‹
  - æ·±å…¥è§£æ
  - å·¥å…·
  - æ–°åŠŸèƒ½
- èµ„æº
  - æ•°æ®ç®¡ç†
  - æ£€ç´¢
  - æ·±åº¦ç ”ç©¶ MCP
  - ChatGPT Actions

- æ•´ä½“ç»“æ„åˆ†ä¸ºâ€œå…¥é—¨â€ã€â€œæ ¸å¿ƒæ¦‚å¿µâ€ã€â€œAPI æŒ‡å—â€ã€â€œå·¥å…·â€ã€â€œæ™ºèƒ½ä½“â€ã€â€œå®æ—¶ APIâ€ã€â€œæ¨¡å‹ä¼˜åŒ–â€ã€â€œä¸“ç”¨æ¨¡å‹â€ã€â€œCodexâ€ã€â€œæœ€ä½³å®è·µâ€ã€â€œåŠ©æ‰‹ APIâ€ã€â€œèµ„æºâ€ç­‰æ¨¡å—ã€‚
- åˆå­¦è€…å»ºè®®ä»â€œå…¥é—¨â€æ¨¡å—å¼€å§‹ï¼Œäº†è§£å¹³å°åŸºç¡€å’Œå¦‚ä½•å¿«é€Ÿä¸Šæ‰‹ã€‚
- â€œæ ¸å¿ƒæ¦‚å¿µâ€å¸®åŠ©ç†è§£æ–‡æœ¬ã€å›¾åƒã€è¯­éŸ³ç­‰ AI èƒ½åŠ›çš„åŸºæœ¬åŸç†ã€‚
- â€œAPI æŒ‡å—â€ä¸â€œå·¥å…·â€æ¨¡å—é€‚åˆå¼€å‘è€…æŸ¥é˜…å…·ä½“ç”¨æ³•å’Œé›†æˆæ–¹æ³•ã€‚
- â€œæœ€ä½³å®è·µâ€ä¸â€œèµ„æºâ€æ¨¡å—æä¾›äº†å®‰å…¨ã€ä¼˜åŒ–ã€åˆè§„ç­‰æ–¹é¢çš„å»ºè®®å’Œæ”¯æŒã€‚
- å…¶ä½™æ¨¡å—å¦‚â€œæ¨¡å‹ä¼˜åŒ–â€ã€â€œä¸“ç”¨æ¨¡å‹â€ã€â€œCodexâ€ç­‰é€‚åˆæœ‰ä¸€å®šåŸºç¡€åæ·±å…¥å­¦ä¹ å’Œæ‰©å±•ã€‚

ä¸åŒ prompt çš„å®šä¹‰ï¼Œopenai æ–‡æ¡£ä»‹ç»å¯ä»¥æŠŠç³»ç»Ÿæç¤ºè¯å’Œç”¨æˆ·æç¤ºè¯çš„å…³ç³»ç†è§£ä¸ºå‡½æ•°è°ƒç”¨ï¼Œç”¨æˆ·æç¤ºè¯æä¾›å‚æ•°ï¼Œç³»ç»Ÿæç¤ºè¯æä¾›é€»è¾‘

```js
systemPrompt(userPrompt);
```

é™¤äº† userPrompt, openai è¿˜æœ‰ä¸€ä¸ª assistantPrompt, åªå¤šæ¬¡å¯¹è¯ç”±LLMäº§ç”Ÿçš„ç»“æœï¼Œä¹Ÿå°†ä½œä¸ºæœ‰æ•ˆçš„Prompt

```js
import OpenAI from "openai";

const openai = new OpenAI();

let history = [
  {
    role: "user",
    content: "tell me a joke",
  },
];

const response = await openai.responses.create({
  model: "gpt-4o-mini",
  input: history,
  store: true,
});
// ç¬¬ä¸€è½®å¯¹è¯ç»“æŸ
console.log(response.output_text);

// Add the ç¬¬ä¸€è½®å¯¹è¯ response to the history
history = [
  ...history,
  ...response.output.map((el) => {
    // TODO: Remove this step
    delete el.id;
    return el; // role å°†ä¼šæ˜¯ assistant
  }),
];

// å¼€å§‹ç¬¬äºŒè½®å¯¹è¯
history.push({
  role: "user",
  content: "tell me another",
});

const secondResponse = await openai.responses.create({
  model: "gpt-4o-mini",
  input: history,
  store: true,
});

console.log(secondResponse.output_text);
```

ğŸ‘‡ openai å†…ç½®é€šè¿‡å¯¹è¯idå¤„ç†æºå¸¦å¤šè½®å¯¹è¯å†…å®¹ï¼Œ`previous_response_id`ï¼ˆåŒ…å«input å’Œ outputï¼‰ ç­‰åŒäºä¸Šé¢æ‰‹åŠ¨ push inputs

> æœ¬è´¨ä¸Šæ˜¯ç”±openaiè°ƒç”¨äº‘ç«¯çš„å¯¹è¯å†…å®¹æ¥ push inputsï¼Œä¼ å…¥ LLM çš„ context è¿˜æ˜¯å®Œæ•´çš„(æ”¶è´¹)

```js
import OpenAI from "openai";

const openai = new OpenAI();

const response = await openai.responses.create({
  model: "gpt-4o-mini",
  input: "tell me a joke",
  store: true,
});

console.log(response.output_text);

const secondResponse = await openai.responses.create({
  model: "gpt-4o-mini",
  previous_response_id: response.id, // ç­‰åŒäº push inputs
  input: [{ role: "user", content: "explain why this is funny." }],
  store: true,
});

console.log(secondResponse.output_text);
```

Funtion Call

myServer -> LLM -> myServer -> otherServer -> myServer -> LLM

ä½¿ç”¨ JSON schema å®šä¹‰functionå¦‚ä½•è¢«è°ƒç”¨ï¼Œä½œç”¨ã€å…¥å‚ã€æšä¸¾ ...ğŸ¤” åº”è¯¥æœ‰æ ¹æ®tsç±»å‹å®šä¹‰æˆ–è€…æ ¹æ®å‡½æ•°ä»£ç ç”Ÿæˆ JSON schemaçš„å®šåˆ¶ LLM(callback åˆ° ç»“æ„åŒ–è¾“å‡ºçš„ç« èŠ‚)

LLM å¯ä»¥åå‡ºå¤šä¸ª function call çš„è°ƒç”¨å‚æ•°ï¼ŒmyServer éœ€è¦éå†è¿™äº›ç»“æœï¼Œé€ä¸ªè°ƒç”¨functionï¼Œå¹¶æŠŠç»“æœæ¨å…¥ä¸‹ä¸€æ¬¡çš„inputs

ğŸ‘‡ å¹¶è¡Œæ‰§è¡Œå™¨

```js
// for of è¯­æ³•
for (const toolCall of response.output) {
  const { type, name, arguments, call_id } = toolCall;
  if (type !== "function_call") {
    continue;
  }

  const args = JSON.parse(arguments);

  const result = callFunction(name, args);
  input.push({
    type: "function_call_output",
    call_id,
    output: result.toString(),
  });
}
```

ğŸ‘‡ è°ƒè¯•æ—¶æ‰“å°æµï¼Œä½¿ç”¨ for await of è¯­æ³•ï¼Œæ¯æ¬¡å¾ªç¯ä¼šç­‰å¾…ï¼ˆ`await`ï¼‰ä¸‹ä¸€ä¸ªå¼‚æ­¥ç»“æœè¿”å›

```js
const finalToolCalls = {};

for await (const event of stream) {
  const { type, item, output_index, delta } = event;
  if (type === "response.output_item.added") {
    finalToolCalls[output_index] = item;
  } else if (type === "response.function_call_arguments.delta") {
    // æµå¼æ‹¼æ¥ function call çš„å‚æ•°
    if (finalToolCalls[output_index]) {
      finalToolCalls[output_index].arguments += delta;
    }
  }
}
```
