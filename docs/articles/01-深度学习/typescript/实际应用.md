# TS å®é™…åº”ç”¨

ä»¥ Vite ä¸ºåˆ‡å…¥ç‚¹ï¼Œäº†è§£å›´ç»• TS éœ€è¦å‡†å¤‡çš„ä¸œè¥¿ï¼Œä»¥åŠ TS æ˜¯å¦‚ä½•ç”Ÿæ•ˆçš„

## Vite

```bash
â”œâ”€â”€ tsconfig.json            # åŸºç¡€é…ç½®
â”œâ”€â”€ tsconfig.app.json        # åº”ç”¨ä»£ç é…ç½®
â”œâ”€â”€ tsconfig.node.json       # å·¥å…·é“¾é…ç½®
â””â”€â”€ src/
    â””â”€â”€ vite-env.d.ts        # ç¯å¢ƒç±»å‹å£°æ˜
```

å½“æˆ‘ä»¬ä½¿ç”¨ Vite è„šæ‰‹æ¶ç”Ÿæˆä¸€ä¸ªé¡¹ç›®ç›®å½•æ—¶ï¼Œä¼šå‘ç°å’Œ TS ç›¸å…³çš„æ–‡ä»¶ä¸å°‘ï¼ˆè¿™åœ¨ä¸€ä¸ªç©ºä¸šåŠ¡ä»£ç çš„åˆå§‹é¡¹ç›®é‡Œå¾ˆæ‰çœ¼ï¼‰

## å®‰è£… TS

è®©æˆ‘ä»¬ä»æºå¤´å¼€å§‹ï¼š

é¦–å…ˆçœ‹ä¸€ä¸‹ package.json ä¸­å…³äº ts ä¾èµ–ï¼Œå‘ç°åªå®‰è£…äº† typescript

```json
{
  "devDependencies": {
    "typescript": "^5.7.2",
    "vite": "^6.0.5",
  }
}
```

[å®˜æ–¹æ–‡æ¡£ï¼šTypeScript Tooling in 5 minutes](https://www.typescriptlang.org/docs/handbook/typescript-tooling-in-5-minutes.html)

```
There are two main ways to add TypeScript to your project:

- Via npm (the Node.js package manager)
- By installing TypeScriptâ€™s Visual Studio plugins

For npm users:

> npm install -g typescript

Visual Studio 2017 and Visual Studio 2015 Update 3 include TypeScript language support by default but does not include the TypeScript compiler, tsc.
If you didnâ€™t install TypeScript with Visual Studio, you can still download it.
```

åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­å¼•å…¥ tsï¼Œéœ€è¦ 2 ä¸ªä¸œè¥¿ï¼š

1. npm ä¾èµ–ï¼Œæä¾›å‘½ä»¤æ“ä½œ ts ä»£ç  or è¢«å…¶ä»–æ„å»ºå·¥å…·æ“ä½œï¼Œæä¾›ä¸€ç§æ›´çµæ´»åº•å±‚çš„ä½¿ç”¨æ–¹å¼
2. ä»£ç ç¼–è¾‘å™¨ (VSCode) Plugin æ”¯æŒå®æ—¶ç¼–å†™çš„ç±»å‹æ£€æŸ¥æé†’

è€Œ 1 ä¸ª npm ä¾èµ– typescriptï¼ŒåŒæ—¶åŒ…å«å¤šç§åŠŸèƒ½ï¼Œä¸»è¦æ˜¯ 2 ä¸ªæ˜¾æ€§çš„åŠŸèƒ½ï¼š1. æ‰«æä»£ç è¿›è¡Œç±»å‹æ£€æŸ¥ 2. ç¼–è¯‘ï¼ˆé€šè¿‡ `npx tsc xxx` æ ¹æ® ts è¾“å‡º `js`ï¼‰

æ­£å¦‚å®˜æ–¹æ–‡æ¡£æ‰€è¯´ï¼ŒVSCode å·²ç»å†…ç½®çš„ TS çš„ç±»å‹æ£€æŸ¥åŠŸèƒ½ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬ `TypeScript compiler, tsc` ç¼–è¯‘å™¨åŠŸèƒ½

> å› æ­¤å¦‚æœæˆ‘ä»¬çš„é¡¹ç›®ä¸éœ€è¦ç¼–è¯‘å™¨ï¼ˆæ ¹æ® ts è¾“å‡ºä¸º jsï¼‰åŠŸèƒ½æ—¶ï¼Œç”±äº VSCode å·²ç»å†…ç½®äº†ç±»å‹æ£€æŸ¥åŠŸèƒ½
>
> å¯ä»¥ä¸å®‰è£… npm åŒ…
>
> ä¹Ÿå°±æ„å‘³ç€ğŸ‘†å®˜æ–¹æ–‡æ¡£æŒ‡å‡ºçš„å¼•å…¥ 2 ä¸ªä¸œè¥¿éƒ½ä¸éœ€è¦äº†

ä½ å¯èƒ½ä¼šè¯´ï¼Œç°å®ä¸­æˆ‘ä»¬ä¸ç®¡å†™ Nodejs è„šæœ¬ or Webï¼Œéƒ½åªèƒ½è¯†åˆ« jsï¼Œé‚£å°±å¿…é¡»è¦å®‰è£… npm æ¥ç¼–è¯‘äº†ğŸ¤”

æ˜¯çš„ Web å¿…é¡»è¦ä½¿ç”¨ JSï¼Œä½†æ˜¯ Nodejs åœ¨ v23 ä¹‹åå¯ä»¥è¯†åˆ« tsï¼Œè€Œä¸éœ€è¦æ˜¾å¼çš„è¾“å‡º js æ¥ç»™ Nodejs ä½¿ç”¨

æ‰€ä»¥ï¼å½“æˆ‘ä»¬ç°åœ¨éœ€è¦å†™ä¸€ä¸ª Nodejs é¡¹ç›®æ—¶ï¼Œä¸å†éœ€è¦åˆ»æ„å»æ­å»º TS ç¯å¢ƒï¼Œåªéœ€è¦åœ¨ VSCode ä¸­åˆ›å»º `.ts` æ–‡ä»¶ï¼Œå¼€å§‹ enjoy ts çš„å®æ—¶ç±»å‹æç¤ºï¼Œæœ€åç›´æ¥ `node a.ts` æ‰§è¡Œ

> [Nodejs V22.6 run Ts by natively](https://nodejs.org/en/learn/typescript/run-natively)
>

> `node --experimental-strip-types test.ts`
>
> --experimental-strip-types --å®éªŒæ€§-å‰¥ç¦»-ç±»å‹

## Web é¡¹ç›®

```json
{
  "build": "tsc & vite build",
  "build-only": "vite build",
}
```

Vite å†…éƒ¨åªä¼šä½¿ç”¨ ESBuild çš„æŠ¹é™¤ ts è¯­æ³•åŠŸèƒ½ï¼Œä¸ä¼šå¯¹ ts è¿›è¡Œç±»å‹æ£€æŸ¥

å½“éœ€è¦åœ¨æ„å»ºæ—¶ç¡®ä¿ ts çš„ç±»å‹æ­£ç¡®ï¼Œåº”è¯¥æ‰‹åŠ¨æ‰§è¡Œ `npx tsc` ï¼ˆè¶³å¤Ÿä¿¡ä»»ä»£ç ç¼–è¾‘å™¨å®æ—¶ç±»å‹æ£€æŸ¥å¹¶å³ä½¿ä¿®å¤çš„è¯ï¼Œå¯ä»¥ä¸æ‰§è¡Œï¼‰

## tsconfig

TS å†…éƒ¨æœ‰é»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œä¹Ÿæœ‰å†…ç½®çš„è¯»å–é…ç½®æ–‡ä»¶å¯»å€é€»è¾‘ï¼Œåœ¨ä¸€ä¸ªé¡¹ç›®é‡Œï¼Œä¸éœ€è¦ç»™æ„å»ºå·¥å…· or å…¶ä»–å·¥å…· æ˜¾å¼çš„æŒ‡å®š tsconfig æ–‡ä»¶ï¼Œåªéœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª `tsconfig.json` æ–‡ä»¶å³å¯

[é…ç½®è¯¦ç»†ç†è§£](./1-tsconfig-é…ç½®ç†è§£)

ğŸ‘‡ Vite tsconfig.json ä¸»æ–‡ä»¶æ²¡æœ‰é…ç½®å†…å®¹ï¼Œè€Œæ˜¯æ¨¡å—åŒ–åŒºåˆ†äº† nodejs å’Œ web çš„ ts ä¸åŒé…ç½®

è¿™ä¹Ÿæ˜¯ç°ä»£å‰ç«¯é¡¹ç›®éœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼šä¸€ä¸ªé¡¹ç›®é‡Œæœ‰äº›ä»£ç è¿è¡Œåœ¨ nodejs ç¯å¢ƒï¼ˆç¼–è¯‘æ—¶ï¼‰ï¼Œæœ‰äº›ä»£ç åˆ™è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒï¼ˆè¿è¡Œæ—¶ï¼‰

```json
{
  // æŒ‡å®šè¦åŒ…å«åœ¨ç¼–è¯‘ä¸­çš„æ–‡ä»¶åˆ—è¡¨ã€‚åœ¨è¿™é‡Œï¼Œå®ƒæ˜¯ä¸€ä¸ªç©ºæ•°ç»„ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨ "references" æ¥å¼•ç”¨å…¶ä»–é…ç½®æ–‡ä»¶ã€‚
  "files": [],
  // æŒ‡å®šè¦å¼•ç”¨çš„å…¶ä»– TypeScript é…ç½®æ–‡ä»¶ã€‚è¿™å…è®¸æˆ‘ä»¬å°†é…ç½®æ‹†åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç»„ç»‡å’Œç®¡ç†ã€‚
  "references": [
    // Web åº”ç”¨ç¨‹åºä»£ç çš„é…ç½®ã€‚
    { "path": "./tsconfig.app.json" },
    // Node.js ç¯å¢ƒä»£ç çš„é…ç½®ã€‚
    { "path": "./tsconfig.node.json" }
  ]
}
```

::: details tsconfig.app.json é€è¡Œæ³¨é‡Š

```json
{
  "compilerOptions": {
    // æŒ‡å®šç”¨äºå­˜å‚¨å¢é‡ç¼–è¯‘ä¿¡æ¯çš„æ–‡ä»¶çš„è·¯å¾„ã€‚è¿™æœ‰åŠ©äºåŠ å¿«åç»­çš„æ„å»ºé€Ÿåº¦ã€‚
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    // æŒ‡å®š ECMAScript ç›®æ ‡ç‰ˆæœ¬ã€‚ES2020 æ˜¯ä¸€ä¸ªè¾ƒæ–°çš„ç‰ˆæœ¬ï¼Œæ”¯æŒç°ä»£ JavaScript è¯­æ³•ã€‚
    "target": "ES2020",
    // ä½¿ç”¨ `define` å±æ€§æ¥å®šä¹‰ç±»å­—æ®µã€‚
    "useDefineForClassFields": true,
    // æŒ‡å®šæ¨¡å—ä»£ç ç”Ÿæˆæ–¹å¼ã€‚ESNext å…è®¸ä½¿ç”¨æœ€æ–°çš„ JavaScript æ¨¡å—è¯­æ³•ã€‚
    "module": "ESNext",
    // æŒ‡å®šè¦åŒ…å«åœ¨ç¼–è¯‘ä¸­çš„åº“æ–‡ä»¶ã€‚
    "lib": [
      "ES2020", // åŒ…å« ES2020 çš„ç±»å‹å®šä¹‰ã€‚
      "DOM", // åŒ…å« DOM API çš„ç±»å‹å®šä¹‰ï¼Œç”¨äºæµè§ˆå™¨ç¯å¢ƒã€‚
      "DOM.Iterable" // åŒ…å« DOM ä¸­å¯è¿­ä»£å¯¹è±¡çš„ç±»å‹å®šä¹‰ã€‚
    ],
    // è·³è¿‡å¯¹å£°æ˜æ–‡ä»¶ï¼ˆ`.d.ts`ï¼‰çš„ç±»å‹æ£€æŸ¥ï¼Œä»¥åŠ å¿«ç¼–è¯‘é€Ÿåº¦ã€‚
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler", // ä½¿ç”¨ bundler æ¨¡å¼è¿›è¡Œæ¨¡å—è§£æï¼Œä¸ Vite ç­‰æ‰“åŒ…å·¥å…·å…¼å®¹ã€‚
    "allowImportingTsExtensions": true, // å…è®¸åœ¨å¯¼å…¥è¯­å¥ä¸­ä½¿ç”¨ `.ts` æ‰©å±•åã€‚
    "isolatedModules": true, // å°†æ¯ä¸ªæ–‡ä»¶ä½œä¸ºå•ç‹¬çš„æ¨¡å—è¿›è¡Œç¼–è¯‘ï¼Œä¸ Vite çš„å·¥ä½œæ–¹å¼å…¼å®¹ã€‚
    "moduleDetection": "force", // å¼ºåˆ¶å¯ç”¨æ¨¡å—æ£€æµ‹ã€‚
    "noEmit": true, // ä¸ç”Ÿæˆè¾“å‡ºæ–‡ä»¶ï¼ˆ`.js`ï¼‰ï¼Œå› ä¸º Vite ä¼šå¤„ç†ä»£ç çš„è½¬æ¢å’Œæ‰“åŒ…ã€‚
    "jsx": "react-jsx", // æ”¯æŒ React çš„ JSX è¯­æ³•ï¼Œå¹¶ä½¿ç”¨æ–°çš„ JSX è½¬æ¢æ–¹å¼ã€‚

    /* Linting */
    "strict": true, // å¯ç”¨æ‰€æœ‰ä¸¥æ ¼ç±»å‹æ£€æŸ¥é€‰é¡¹ï¼Œä»¥æé«˜ä»£ç è´¨é‡ã€‚
    "noUnusedLocals": true, // æŠ¥å‘Šæœªä½¿ç”¨çš„å±€éƒ¨å˜é‡ã€‚
    "noUnusedParameters": true, // æŠ¥å‘Šæœªä½¿ç”¨çš„å‡½æ•°å‚æ•°ã€‚
    "noFallthroughCasesInSwitch": true, // é˜²æ­¢ switch è¯­å¥ä¸­çš„ case ç©¿é€ã€‚
    "noUncheckedSideEffectImports": true // å¦‚æœå¯¼å…¥çš„æ¨¡å—æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œåˆ™å‘å‡ºé”™è¯¯ã€‚
  },
  // æŒ‡å®šè¦åŒ…å«åœ¨ç¼–è¯‘ä¸­çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚è¿™é‡ŒæŒ‡å®šäº† `src` ç›®å½•ä¸‹çš„æ‰€æœ‰ TypeScript æ–‡ä»¶ã€‚
  "include": ["src"]
}
```

:::

::: details tsconfig.node.json é€è¡Œæ³¨é‡Š

```json
{
  "compilerOptions": {
    // æŒ‡å®šç”¨äºå­˜å‚¨å¢é‡ç¼–è¯‘ä¿¡æ¯çš„æ–‡ä»¶çš„è·¯å¾„ã€‚
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.node.tsbuildinfo",
    // æŒ‡å®š ECMAScript ç›®æ ‡ç‰ˆæœ¬ã€‚ES2022 æ˜¯ä¸€ä¸ªè¾ƒæ–°çš„ç‰ˆæœ¬ï¼Œæ”¯æŒç°ä»£ JavaScript è¯­æ³•ã€‚
    "target": "ES2022",
    // æŒ‡å®šæ¨¡å—ä»£ç ç”Ÿæˆæ–¹å¼ã€‚ESNext å…è®¸ä½¿ç”¨æœ€æ–°çš„ JavaScript æ¨¡å—è¯­æ³•ã€‚
    "module": "ESNext",
    // æŒ‡å®šè¦åŒ…å«åœ¨ç¼–è¯‘ä¸­çš„åº“æ–‡ä»¶ã€‚
    "lib": [
      "ES2023" // åŒ…å« ES2023 çš„ç±»å‹å®šä¹‰ã€‚
    ],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  // æŒ‡å®šè¦åŒ…å«åœ¨ç¼–è¯‘ä¸­çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚è¿™é‡ŒæŒ‡å®šäº† `vite.config.ts`
  "include": ["vite.config.ts"]
}
```

:::

ğŸ‘† åœ¨ node.config ä¸­çœç•¥äº†ä¸€äº›é‡å¤çš„æ³¨é‡Šï¼Œæˆ‘ä»¬å¯¹æ¯”æ¥çœ‹

| é…ç½®é¡¹ | tsconfig.app.json | tsconfig.node.json | åŒºåˆ«è¯´æ˜ |
|---------|-------------------|-------------------|------------|
| include | ["src"] | ["vite.config.ts"] | ç¼–è¯‘èŒƒå›´ä¸åŒï¼Œapp ç¼–è¯‘ src ç›®å½•ï¼Œnode åªç¼–è¯‘ vite é…ç½®æ–‡ä»¶ |
| tsBuildInfoFile | "./node_modules/.tmp/tsconfig.app.tsbuildinfo" | "./node_modules/.tmp/tsconfig.node.tsbuildinfo" | æ–‡ä»¶åä¸åŒ |
| target | ES2020 | ES2022 | node é…ç½®ä½¿ç”¨æ›´æ–°çš„ ES ç‰ˆæœ¬ |
| lib | ["ES2020", "DOM", "DOM.Iterable"] | ["ES2023"] | app åŒ…å«æµè§ˆå™¨ DOM ç±»å‹ï¼Œnode åªåŒ…å« ES2023 æ ‡å‡†åº“ |
| useDefineForClassFields | true | ä¸åŒ…å« | app é…ç½®æ˜ç¡®æŒ‡å®šäº†ç±»å­—æ®µçš„å®šä¹‰è¡Œä¸º |
| jsx | "react-jsx" | ä¸åŒ…å« | app æ”¯æŒ JSX è¯­æ³• |
| - module: "ESNext"<br>- skipLibCheck: true<br>- moduleResolution: "bundler"<br>- allowImportingTsExtensions: true<br>- isolatedModules: true<br>- moduleDetection: "force"<br>- noEmit: true<br>- strict: true<br>- noUnusedLocals: true<br>- noUnusedParameters: true<br>- noFallthroughCasesInSwitch: true<br>- noUncheckedSideEffectImports: true | ç›¸åŒ | ç›¸åŒ | Lintingã€Bundler ç›¸åŒ |

ğŸ‘‡ å¤§éƒ¨åˆ†é…ç½®æ˜¯ç›¸åŒçš„

```json
// æŒ‡å®šæ¨¡å—ä»£ç ç”Ÿæˆæ–¹å¼ã€‚ESNext å…è®¸ä½¿ç”¨æœ€æ–°çš„ JavaScript æ¨¡å—è¯­æ³•ã€‚
"module": "ESNext",
// è·³è¿‡å¯¹å£°æ˜æ–‡ä»¶ï¼ˆ`.d.ts`ï¼‰çš„ç±»å‹æ£€æŸ¥ï¼Œä»¥åŠ å¿«ç¼–è¯‘é€Ÿåº¦ã€‚
"skipLibCheck": true,

/* Bundler mode */
"moduleResolution": "bundler", // ä½¿ç”¨ bundler æ¨¡å¼è¿›è¡Œæ¨¡å—è§£æï¼Œä¸ Vite ç­‰æ‰“åŒ…å·¥å…·å…¼å®¹ã€‚
"allowImportingTsExtensions": true, // å…è®¸åœ¨å¯¼å…¥è¯­å¥ä¸­ä½¿ç”¨ `.ts` æ‰©å±•åã€‚
"isolatedModules": true, // å°†æ¯ä¸ªæ–‡ä»¶ä½œä¸ºå•ç‹¬çš„æ¨¡å—è¿›è¡Œç¼–è¯‘ï¼Œä¸ Vite çš„å·¥ä½œæ–¹å¼å…¼å®¹ã€‚
"moduleDetection": "force", // å¼ºåˆ¶å¯ç”¨æ¨¡å—æ£€æµ‹ã€‚
"noEmit": true, // ä¸ç”Ÿæˆè¾“å‡ºæ–‡ä»¶ï¼ˆ`.js`ï¼‰ï¼Œå› ä¸º Vite ä¼šå¤„ç†ä»£ç çš„è½¬æ¢å’Œæ‰“åŒ…ã€‚

/* Linting */
"strict": true, // å¯ç”¨æ‰€æœ‰ä¸¥æ ¼ç±»å‹æ£€æŸ¥é€‰é¡¹ï¼Œä»¥æé«˜ä»£ç è´¨é‡ã€‚
"noUnusedLocals": true, // æŠ¥å‘Šæœªä½¿ç”¨çš„å±€éƒ¨å˜é‡ã€‚
"noUnusedParameters": true, // æŠ¥å‘Šæœªä½¿ç”¨çš„å‡½æ•°å‚æ•°ã€‚
"noFallthroughCasesInSwitch": true, // é˜²æ­¢ switch è¯­å¥ä¸­çš„ case ç©¿é€ã€‚
"noUncheckedSideEffectImports": true // å¦‚æœå¯¼å…¥çš„æ¨¡å—æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œåˆ™å‘å‡ºé”™è¯¯ã€‚
```

## env.d.ts

[TS æ¨¡å—åŒ–](./TS-æ¨¡å—åŒ–#é-js-æ–‡ä»¶æ¨¡å—æ”¯æŒ)

```ts
/// <reference types="vite/client" />
```

1. æä¾›äº†`d.ts` å…¨å±€å¤„ç† `é JS æ–‡ä»¶` çš„æ¨¡å—ï¼ˆä¸€èˆ¬æ˜¯å¿½ç•¥ or æ‰‹å†™ï¼‰
2. æä¾›äº† vite å†…ç½®çš„ç¯å¢ƒå˜é‡ï¼Œå€ŸåŠ© `importMeta` æ¥å®ç°è¿è¡Œæ—¶æ³¨å…¥ç¯å¢ƒå˜é‡

- é JS æ–‡ä»¶ç±»å‹æ”¯æŒï¼š [vite/client.d.ts - github](https://github.com/vitejs/vite/blob/main/packages/vite/client.d.ts)

- vite å†…ç½®ç¯å¢ƒå˜é‡ [importMeta.d.ts - github](https://github.com/vitejs/vite/blob/main/packages/vite/types/importMeta.d.ts)

![](https://kingan-md-img.oss-cn-guangzhou.aliyuncs.com/blog/20250307162630031.png?x-oss-process=image/format,webp/resize,w_640)

[ç¯å¢ƒå˜é‡ä½¿ç”¨-vite å®˜æ–¹æ–‡æ¡£](https://cn.vitejs.dev/guide/env-and-mode)

```js
console.log(import.meta.env.BASE_URL)
console.log(import.meta.env.MODE)
```

ğŸ‘‡ æˆ‘ä»¬ç”±æ­¤å»¶ä¼¸ä¸€ä¸‹æ„å»ºå·¥å…·é‡Œç¯å¢ƒå˜é‡çš„åŸç†

æ„å»ºå·¥å…·ä¼šåœ¨æ„å»ºæ—¶æ‰«æä»£ç ä¸­ä½¿ç”¨åˆ°çš„åœ°æ–¹ï¼Œå…¨éƒ¨æ›¿æ¢æˆå¸¸é‡

- webpack ä»¥ nodejs è¯­æ³•ä¸ºå‡† `process.env.xxx`ï¼Œæ–¹ä¾¿è‡ªèº«æ„å»ºå·¥å…·åœ¨ nodejs ç¯å¢ƒä½¿ç”¨ï¼Œå³åœ¨ Web æµè§ˆå™¨è¿è¡Œæ—¶çš„ä¸šåŠ¡ä»£ç  ç¼–å†™æ—¶ä¼šå‡ºç° nodejs çš„è¯­æ³•ï¼Œä»è€Œè®©äººæœ‰ç‚¹å‰²è£‚çš„æ„Ÿè§‰
- vite ä»¥ æµè§ˆå™¨è¯­æ³•ä¸ºå‡† `import.meta.env.xxx`ï¼Œç”±æ„å»ºå·¥å…·å¤„ç†è¿™ç§è¯­æ³•ï¼ˆä¸å›°éš¾ï¼Œè¿™åœ¨ [nodejs å’Œ æµè§ˆå™¨éƒ½è®¤è¯†](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/import.meta)ï¼‰, æ³¨æ„åŸç”Ÿçš„ `import.meta.` å¹¶æ²¡æœ‰ `env` è¿™ä¸ªå¯¹è±¡ã€‚`import.meta.url`ç»“åˆ `new URL()` å¾ˆå¥½ç”¨ï¼Œå¯ä»¥å¤šäº†è§£

```js
// webpack ç¯å¢ƒå˜é‡ plugin
module.exports = {
  // ...
  plugins: [
    new webpack.DefinePlugin({
      'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV || 'development'),
      'process.env.API_URL': JSON.stringify(process.env.API_URL),
    }),
  ],
};
```

| ç‰¹æ€§             | Webpack                                  | Vite                                     |
| ---------------- | ---------------------------------------- | ---------------------------------------- |
| è®¿é—®æ–¹å¼         | `process.env.VAR_NAME`                   | `import.meta.env.VAR_NAME`               |
| æ’ä»¶             | `DefinePlugin`ã€`EnvironmentPlugin`ã€`dotenv-webpack` | æ— éœ€é¢å¤–æ’ä»¶ï¼Œå†…ç½®æ”¯æŒ                   |
| ç±»å‹å®šä¹‰         | éœ€è¦æ‰‹åŠ¨é…ç½®                             | `vite/client` æä¾›ç±»å‹å®šä¹‰                |
| å¤„ç†æ–¹å¼         | æ„å»ºæ—¶æ›¿æ¢                               | æ„å»ºæ—¶æ›¿æ¢                    |
| è§„èŒƒ             | ä¸ç¬¦åˆ ESM è§„èŒƒ                          | ç¬¦åˆ ESM è§„èŒƒ                          |
| å…¨å±€å˜é‡æ±¡æŸ“     | å­˜åœ¨                                     | é¿å…                                     |
| çµæ´»æ€§           | è¾ƒä½                                     | è¾ƒé«˜                                     |
| é…ç½®å¤æ‚åº¦       | è¾ƒé«˜                                     | è¾ƒä½                                     |
